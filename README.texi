\input texinfo    @c -*- texinfo -*-
@c %**start of header
@setfilename README.info
@settitle org-outlook
@documentencoding UTF-8
@documentlanguage en
@c %**end of header

@dircategory Emacs
@direntry
* Org Outlook: (org-outlook). org-outlook.
@end direntry

@finalout
@titlepage
@title org-outlook
@author Ian FitzPatrick
@end titlepage

@contents

@ifnottex
@node Top
@top org-outlook

Conquer your Microsoft Outlook agenda from the comfort of Emacs.

@strong{Disclaimer:} org-outlook is currently in beta. Updates & responses to issues will be sporadic.

@end ifnottex

@menu
* Contents::
* Features::
* Screenshots::
* Installation::
* Usage::
* Changelog::
* Notes::
* License::

@detailmenu
--- The Detailed Node Listing ---

Installation

* Prerequisites::
* Dependencies::
* Optional::
* Quelpa::

Usage

* Commands::
* Tips::

Changelog

* 0.1.2-beta (2025-11-29): 012-beta (2025-11-29). 
* 0.1.1-beta (2025-11-29): 011-beta (2025-11-29). 
* 0.1.0-beta (2025-11-20): 010-beta (2025-11-20). 
* 0.0.5-alpha: 005-alpha. 
* 0.0.4-alpha: 004-alpha. 
* 0.0.3-alpha: 003-alpha. 
* 0.0.2-pre-alpha: 002-pre-alpha. 
* 0.0.1-pre-alpha: 001-pre-alpha. 

0.1.2-beta (2025-11-29)

* New Features::
* Fixed Issues::

0.1.1-beta (2025-11-29)

* Fixed Issues: Fixed Issues (1). 
* Breaking Changes::

0.1.0-beta (2025-11-20)

* Fixed Issues: Fixed Issues (2). 
* New Features: New Features (1). 
* Breaking Changes: Breaking Changes (1). 

Notes

* Known issues::
* Fixed in 0.1.2-beta: Fixed in 012-beta. 
* Fixed in 0.1.1-beta: Fixed in 011-beta. 
* Fixed in 0.1.0-beta: Fixed in 010-beta. 

@end detailmenu
@end menu

@node Contents
@chapter Contents

@itemize
@item
@item
@item
@item
@item
@item
@end itemize

@node Features
@chapter Features

@itemize
@item
@strong{Integrated with} @uref{https://github.com/org-roam, org-roam}
@itemize
@item
Find outlook events with @samp{org-roam-node-find}
@item
Refile outlook events to any file within @samp{org-roam-directory}
@item
Each recurring event instance has unique ID for individual refiling
@end itemize
@item
@strong{Accept and Decline meeting requests from the agenda buffer}
@item
@strong{Join Teams calls directly from the agenda buffer} (launches Teams or web browser)
@item
@strong{At-a-glance overview of your appointments and free timeslots when used with} @uref{https://github.com/ichernyshovvv/org-timeblock, org-timeblock}
@item
Org @strong{capture template} to quickly plan meetings (needs testing).
@end itemize

@emph{Planned features & improvements:}

@itemize
@item
Reduce the number of dependencies
@item
More configurability  
@item
Two-way sync of event body (owned events only).
@end itemize

@emph{Future:}

@itemize
@item
Org contacts integration
@end itemize

@node Screenshots
@chapter Screenshots

@image{images/org-outlook-demo,,,,png}

@node Installation
@chapter Installation

@menu
* Prerequisites::
* Dependencies::
* Optional::
* Quelpa::
@end menu

@node Prerequisites
@section Prerequisites

Upon first launch you will be asked to give @samp{org-outlook} permission to read and write to
your Outlook calendar. Note: Some organisations will have disabled third-party
applications. In this case, unfortunately, you won't be able to use @samp{org-outlook}.

@node Dependencies
@section Dependencies

@itemize
@item
@uref{https://www.gnupg.org/, gnupg}: org-outlook requires you to have a public/private gpg keypair capable of encryption
@item
@uref{http://github.com/lujun9972/html2org.el, html2org}
@item
@uref{https://github.com/ndwarshuis/org-ml, org-ml}
@item
@uref{https://github.com/jeremy-compostella/org-msg, org-msg}  
@item
@uref{https://github.com/tkf/emacs-request/tree/master, emacs-request}  
@item
@uref{https://github.com/hniksic/emacs-htmlize, htmlize}
@end itemize

@node Optional
@section Optional

A standard oauth client is provided with @samp{org-outlook}, you are of course, free to use your
own Microsoft Entra App Registration instead. To do so you will need to create an App
Registration in Microsoft Entra (Formally Azure Active Directory) via
@uref{https://portal.azure.com}. Optionally make a note of your @samp{tenant-id} (you can provide
@samp{org-outlook-tenant-id} to restrict the scope of your app to your Azure tenant). The app
will need the @samp{Calendars.Read}, @samp{Calendars.ReadWrite}, and @samp{offline_access} API
permissions. Under "Authentication" click @samp{Add a platform} and add @samp{http://localhost:9004} as
the redirect uri. At the bottom of the page ensure @samp{Allow public client flows} is toggled to
"Yes". From the "Overview" tab copy the @samp{Application (client) id} and insert into your
config as specified below.

@node Quelpa
@section Quelpa

The package @samp{org-outlook} is not currently available from @uref{https://melpa.org/#/org-ql, MELPA}, but can be installed
directly from github with @uref{https://framagit.org/steckerhalter/quelpa, Quelpa}.

Installing with @uref{https://framagit.org/steckerhalter/quelpa, Quelpa} is easy:

@enumerate
@item
Install @uref{https://framagit.org/steckerhalter/quelpa-use-package#installation, quelpa-use-package} (which can be installed directly from MELPA).
@item
Add this form to your init file:
@end enumerate

@lisp
(use-package org-outlook
  :quelpa (org-outlook :fetcher github :repo "ifitzpat/org-outlook")
  :config
  ;; Optional: Use your own Microsoft Entra App Registration
  ;(setq org-outlook-client-id "client-id-of-your-registered-app")
  ;(setq org-outlook-tenant-id "your-azure-tenant-id")

  ;; Required settings
  (setq org-outlook-gpg-recipient "you@@example.com")
  (setq org-outlook-local-timezone "Europe/Berlin") ; Your local time zone
  (setq org-outlook-file "/path/to/outlook.org")

  ;; Sync range (number of days)
  (setq org-outlook-sync-start 14)  ; days in the past to keep in sync
  (setq org-outlook-sync-end 90)    ; days in the future to keep in sync

  ;; Optional: Customize full sync frequency (default: 7 days)
  (setq org-outlook-full-sync-interval-days 7)  ; weekly validation
  ;(setq org-outlook-full-sync-interval-days 14) ; bi-weekly validation
  ;(setq org-outlook-full-sync-interval-days nil) ; disable automatic full syncs

  ;; Optional: Set your email for availability checking functions
  (setq org-outlook-user-email "your.email@@company.com")
  )
@end lisp

@node Usage
@chapter Usage

@itemize
@item
@item
@end itemize

@menu
* Commands::
* Tips::
@end menu

@node Commands
@section Commands

@itemize
@item
@strong{Syncing Outlook events:}
@itemize
@item
@samp{M-x org-outlook-sync} - Intelligent sync (uses delta sync when possible, falls back to full sync as needed)
@item
@samp{C-u M-x org-outlook-sync} - Force full sync (syncs all events regardless)
@item
@samp{M-x org-outlook-full-sync} - Direct full sync
@end itemize

@strong{How sync works:}
@itemize
@item
@strong{First run}: Automatically performs full sync and initializes delta tracking
@item
@strong{Daily use}: Fast delta sync (only processes changes since last sync)
@item
@strong{Weekly}: Automatic full sync for validation (configurable with @samp{org-outlook-full-sync-interval-days})
@item
@strong{Error recovery}: Falls back to full sync if delta sync fails
@item
@strong{Deleted events}: Automatically removed during delta sync
@end itemize

@item
@strong{Accepting a meeting request:}
@itemize
@item
With point on the entry in the agenda view or within the org entry body: @samp{org-outlook-accept-event}
@end itemize
@item
@strong{Declining a meeting request:}
@itemize
@item
With point on the entry in the agenda view or within the org entry body: @samp{org-outlook-decline-event}
@end itemize
@item
@strong{Joining a Teams meeting:}
@itemize
@item
With point on the entry in the agenda view or within the org entry body: @samp{org-outlook-join-teams-call} 
@end itemize

@item
@strong{Creating new meetings with org-capture:}
@itemize
@item
@samp{C-c c o} - Create new Outlook meeting using org-capture template
@item
The template will prompt for:
@itemize
@item
Event title
@item
Invitees (space-separated email addresses)
@item
Location
@item
Meeting time (org timestamp format)
@end itemize
@item
Upon finalization (@samp{C-c C-c}), the system automatically:
@itemize
@item
Checks availability of all invitees
@item
Warns if conflicts exist with options to continue, edit, or cancel
@item
Creates the event in Outlook if proceeding
@end itemize
@end itemize

@item
@strong{Checking availability:}
@itemize
@item
@samp{M-x org-outlook-check-availability} - Interactive availability check for multiple people
@item
@samp{org-outlook-persons-available-p} - Programmatic availability check (returns t/nil)
@item
@samp{org-outlook-i-am-available-p} - Check your own availability (requires @samp{org-outlook-user-email} to be set)
@end itemize

@strong{Example usage:}
@lisp
     ;; Set your email for convenience functions
     (setq org-outlook-user-email "your.email@@company.com")
     
     ;; Check if you're free for a meeting
     (org-outlook-i-am-available-p "2025-11-30T14:00:00" "2025-11-30T15:00:00")
     
     ;; Check if multiple people are all available
     (org-outlook-persons-available-p '("person1@@company.com" 
                                       "person2@@company.com")
                                     "2025-11-30T14:00:00" 
                                     "2025-11-30T15:00:00")
     
     ;; Interactive availability report
     (org-outlook-check-availability '("colleague@@company.com") 
                                    "2025-11-30T09:00:00" 
                                    "2025-11-30T17:00:00")
@end lisp
@end itemize

@node Tips
@section Tips

@itemize
@item
Calling @samp{org-outlook-sync} via @samp{emacs --batch} avoids blocking your main emacs session.

@item
@strong{Creating meetings with org-capture workflow:}
@enumerate
@item
Press @samp{C-c c o} to start the capture template
@item
Enter event title when prompted
@item
Fill in the template:
@itemize
@item
@samp{INVITEES:} Space-separated email addresses (e.g., @samp{john@@company.com mary@@company.com})
@item
@samp{LOCATION:} Meeting location or "Teams" for online meetings  
@item
@samp{MEETING-TIME:} Use org timestamp (e.g., @samp{<2025-12-01 Mon 14:00-15:00>})
@end itemize
@item
Press @samp{C-c C-c} to finalize
@item
If conflicts are detected, choose from:
@itemize
@item
@samp{(c)ontinue anyway} - Proceed despite conflicts
@item
@samp{(e)dit capture} - Return to edit invitees/time
@item
@samp{(q)uit capture} - Cancel the meeting creation
@end itemize
@item
Meeting is automatically created in Outlook and synced to your org file
@end enumerate
@end itemize

@node Changelog
@chapter Changelog

@emph{Note:} Breaking changes may be made before version 1.0, but in the event of major changes, attempts at backward compatibility will be made with obsolescence declarations, translation of arguments, etc.  Users who need stability guarantees before 1.0 may choose to use tagged stable releases.

@menu
* 0.1.2-beta (2025-11-29): 012-beta (2025-11-29). 
* 0.1.1-beta (2025-11-29): 011-beta (2025-11-29). 
* 0.1.0-beta (2025-11-20): 010-beta (2025-11-20). 
* 0.0.5-alpha: 005-alpha. 
* 0.0.4-alpha: 004-alpha. 
* 0.0.3-alpha: 003-alpha. 
* 0.0.2-pre-alpha: 002-pre-alpha. 
* 0.0.1-pre-alpha: 001-pre-alpha. 
@end menu

@node 012-beta (2025-11-29)
@section 0.1.2-beta (2025-11-29)

@menu
* New Features::
* Fixed Issues::
@end menu

@node New Features
@subsection New Features

@itemize
@item
org-capture-template now checks for attendee availability and allows you to edit the
event if one or more attendees is not available
@end itemize

@node Fixed Issues
@subsection Fixed Issues

@itemize
@item
@strong{No issue number:} fix refresh token timeout
@end itemize

@node 011-beta (2025-11-29)
@section 0.1.1-beta (2025-11-29)

@menu
* Fixed Issues: Fixed Issues (1). 
* Breaking Changes::
@end menu

@node Fixed Issues (1)
@subsection Fixed Issues

@itemize
@item
@strong{Issue #5:} - browser does not launch on MacOS
@item
@strong{Issue #6 -AADSTS501491:} Invalid size of Code@math{_Challenge}
@item
@strong{No issue number:} current-buffer mode change
@end itemize

@node Breaking Changes
@subsection Breaking Changes

@itemize
@item
@samp{org-outlook-code-challenge} is now limited to 43 characters
@end itemize

@node 010-beta (2025-11-20)
@section 0.1.0-beta (2025-11-20)

Major stability and reliability improvements:

@menu
* Fixed Issues: Fixed Issues (2). 
* New Features: New Features (1). 
* Breaking Changes: Breaking Changes (1). 
@end menu

@node Fixed Issues (2)
@subsection Fixed Issues

@itemize
@item
@strong{Issue #1 - DST Duplicates}: Fixed duplicate events during daylight saving time transitions
@itemize
@item
Event IDs now use Outlook ID directly (stable across DST changes)
@item
Fixed timestamp parsing to handle local timezone correctly
@item
Added error handling for stale org-id cache
@item
Each recurring event instance has unique, stable ID
@end itemize
@item
@strong{Issue #2 - Refresh Token}: Fixed reversed logic that prevented automatic OAuth flow when refresh token expired
@item
@strong{Issue #3 - Auth Code Race Conditions}: Removed blocking sleeps and race conditions from OAuth flow
@itemize
@item
Non-blocking authentication with 5-minute timeout (up from 90 seconds)
@item
Proper async handling with state tracking
@item
Better user feedback and error messages
@end itemize
@item
@strong{Issue #4 - Deleted Meetings}: Implemented intelligent hybrid sync
@itemize
@item
Delta sync for fast daily syncs
@item
Automatic full sync for periodic validation
@item
Handles deleted and cancelled events properly
@item
Self-healing with automatic error recovery
@end itemize
@end itemize

@node New Features (1)
@subsection New Features

@itemize
@item
Intelligent hybrid sync system (@samp{org-outlook-sync})
@itemize
@item
Fast delta sync by default
@item
Weekly full sync validation (configurable)
@item
Automatic fallback on errors
@end itemize
@item
New configuration variable: @samp{org-outlook-full-sync-interval-days}
@item
Force full sync with prefix argument: @samp{C-u M-x org-outlook-sync}
@end itemize

@node Breaking Changes (1)
@subsection Breaking Changes

@itemize
@item
@samp{org-outlook-sync} behavior changed: now uses delta sync by default (was full sync)
@item
Old full sync is now @samp{org-outlook-full-sync}
@item
Event IDs changed (will cause re-sync on first run)
@end itemize

@node 005-alpha
@section 0.0.5-alpha

Fix issue where request token times out

@node 004-alpha
@section 0.0.4-alpha

Fix hashing of PKCE code

@node 003-alpha
@section 0.0.3-alpha

Potential fix for duplicate event creation when going to/from DST

@node 002-pre-alpha
@section 0.0.2-pre-alpha

Switch to PKCE oauth flow & provide default auth client

@node 001-pre-alpha
@section 0.0.1-pre-alpha

Initial release

@node Notes
@chapter Notes

@menu
* Known issues::
* Fixed in 0.1.2-beta: Fixed in 012-beta. 
* Fixed in 0.1.1-beta: Fixed in 011-beta. 
* Fixed in 0.1.0-beta: Fixed in 010-beta. 
@end menu

@node Known issues
@section Known issues

@itemize
@item
Accepting an event doesn't change the event status from @samp{REQUEST} to @samp{MEETING} until the
next sync.
@end itemize

@node Fixed in 012-beta
@section Fixed in 0.1.2-beta

@itemize
@item
✅ fix refresh token time-out (fixed in 0.1.2)
@end itemize

@node Fixed in 011-beta
@section Fixed in 0.1.1-beta

@itemize
@item
✅ AADSTS501491: Invalid size of Code@math{_Challenge} (fixed in 0.1.1)
@item
✅ browser does not launch on MacOS (fixed in 0.1.1)
@item
✅ current-buffer mode change (fixed in 0.1.1)
@end itemize

@node Fixed in 010-beta
@section Fixed in 0.1.0-beta

@itemize
@item
✅ DST duplicate events (fixed in 0.1.0)
@item
✅ Refresh token timeout handling (fixed in 0.1.0)
@item
✅ OAuth authentication race conditions (fixed in 0.1.0)
@item
✅ Deleted meetings not removed from org mode (fixed in 0.1.0)
@end itemize

@node License
@chapter License

GPLv3

@bye
